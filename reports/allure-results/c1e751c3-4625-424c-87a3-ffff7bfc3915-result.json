{"name": "Validate EN↔AR response consistency for paired prompts", "status": "failed", "statusDetails": {"message": "AssertionError: [EN↔AR consistency failed]\n  Score: 0.02 (threshold: 0.8)\n  EN: Working Hours of GDRFA Dubai\n  \n  The official working hours for the General Directorate of Residency and Foreigners Affairs (GDRFA) Dubai are:\n  \n  Sunday to Thursday: 8:00 AM to 8:00 PM\n  \n  Additionally:\n  \n  AMER Call Centre (Customer Service): Open 24/7 throughout the year\n  Amer Online Chat: Available from 10:00 AM to 5:00 PM (EST), Sunday to Thursday\n  \n  For more details or updates, you may visit the official GDRFA Dubai website or contact their customer service directly 1.\n  \n  If you need information about a specific branch or service center, please specify, as timings may vary.\n  AR: أنا آسف، لم أتمكن من فهم سؤالك. يرجى توضيح طلبك أو إعادة صياغته حتى أتمكن من مساعدتك بشكل أفضل.\nassert 0.021543167531490326 >= 0.8", "trace": "logged_in_page = <Page url='https://govgpt.sandbox.dge.gov.ae/c/b0bb2fec-db80-4237-a57c-cac52c0a3e02'>\npair = ({'golden': 'GDRFA Dubai operates Sunday to Thursday during typical government hours; check the official website for t...أو توضيح ما تعنيه؟', 'id': 'fallback_test_ar', 'lang': 'ar', 'must_contain': ['عذرًا', 'إعادة الصياغة', 'توضيح'], ...})\n\n    @allure.epic(\"English <-> Arabic semantic consistency\")\n    @allure.feature(\"Multilingual Semantic Consistency\")\n    @allure.story(\"Responses should be semantically consistent across English and Arabic prompts\")\n    @allure.title(\"Validate EN↔AR response consistency for paired prompts\")\n    @allure.description(\"\"\"\n    Objective:\n    To ensure the AI provides consistent answers when asked similar questions\n    in English and Arabic, maintaining intent and meaning.\n    \"\"\")\n    @pytest.mark.parametrize(\"pair\", [\n        pytest.param((en, ar), id=f\"{en.get('id')}↔{ar.get('id')}\")\n        for en, ar in zip(\n            [p for p in json.load(open(\"data/test-data.json\", encoding=\"utf-8\")).get(\"prompts\", []) if p.get(\"lang\") == \"en\"],\n            [p for p in json.load(open(\"data/test-data.json\", encoding=\"utf-8\")).get(\"prompts\", []) if p.get(\"lang\") == \"ar\"]\n        )\n    ])\n    def test_semantic_en_ar_consistency(logged_in_page, pair):\n        page = logged_in_page\n        e, a = pair\n        prompt_en = e[\"user\"]\n        prompt_ar = a[\"user\"]\n    \n        ans_en = _send_and_get_answer(page, prompt_en)\n        ans_ar = _send_and_get_answer(page, prompt_ar)\n    \n        score = sim_xl(ans_en, ans_ar)\n        thr = max(e.get(\"xl_threshold\", 0.80), a.get(\"xl_threshold\", 0.80))\n    \n        # Reporting\n        allure.attach(prompt_en, f\"prompt_en::{e['id']}\", allure.attachment_type.TEXT)\n        allure.attach(prompt_ar, f\"prompt_ar::{a['id']}\", allure.attachment_type.TEXT)\n        allure.attach(ans_en, f\"answer_en::{e['id']}\", allure.attachment_type.TEXT)\n        allure.attach(ans_ar, f\"answer_ar::{a['id']}\", allure.attachment_type.TEXT)\n        allure.attach(f\"{score:.3f}\", f\"sim_xl::{e['id']}::{a['id']}\", allure.attachment_type.TEXT)\n    \n        if score < thr:\n            take_screenshot(page, f\"fail_consistency_{e['id']}_{a['id']}\")\n            attach_dom(page, f\"dom_consistency_{e['id']}_{a['id']}\")\n    \n>       assert score >= thr, (\n            f\"[EN↔AR consistency failed]\\n\"\n            f\"Score: {score:.2f} (threshold: {thr})\\n\"\n            f\"EN: {ans_en}\\nAR: {ans_ar}\"\n        )\nE       AssertionError: [EN↔AR consistency failed]\nE         Score: 0.02 (threshold: 0.8)\nE         EN: Working Hours of GDRFA Dubai\nE         \nE         The official working hours for the General Directorate of Residency and Foreigners Affairs (GDRFA) Dubai are:\nE         \nE         Sunday to Thursday: 8:00 AM to 8:00 PM\nE         \nE         Additionally:\nE         \nE         AMER Call Centre (Customer Service): Open 24/7 throughout the year\nE         Amer Online Chat: Available from 10:00 AM to 5:00 PM (EST), Sunday to Thursday\nE         \nE         For more details or updates, you may visit the official GDRFA Dubai website or contact their customer service directly 1.\nE         \nE         If you need information about a specific branch or service center, please specify, as timings may vary.\nE         AR: أنا آسف، لم أتمكن من فهم سؤالك. يرجى توضيح طلبك أو إعادة صياغته حتى أتمكن من مساعدتك بشكل أفضل.\nE       assert 0.021543167531490326 >= 0.8\n\ntests\\genai\\test_semantic.py:121: AssertionError"}, "description": "\nObjective:\nTo ensure the AI provides consistent answers when asked similar questions\nin English and Arabic, maintaining intent and meaning.\n", "attachments": [{"name": "prompt_en::gdrfa_hours_en", "source": "15734644-5a82-4ea5-a8d8-fcdd0a535462-attachment.txt", "type": "text/plain"}, {"name": "prompt_ar::fallback_test_ar", "source": "2fbeac9f-8fbb-45c4-a4fb-417a3610f26e-attachment.txt", "type": "text/plain"}, {"name": "answer_en::gdrfa_hours_en", "source": "48cb1348-e2f9-4b4a-b0d1-b6e571e6ef5f-attachment.txt", "type": "text/plain"}, {"name": "answer_ar::fallback_test_ar", "source": "1f5c5d35-7b91-4db7-bdff-34b3b3f30072-attachment.txt", "type": "text/plain"}, {"name": "sim_xl::gdrfa_hours_en::fallback_test_ar", "source": "5dddff8e-cddb-4af7-b78b-86f004bb485a-attachment.txt", "type": "text/plain"}, {"name": "fail_consistency_gdrfa_hours_en_fallback_test_ar", "source": "16c1af8e-ac6d-44a7-b73a-7f501b83d587-attachment.png", "type": "image/png"}, {"name": "dom_consistency_gdrfa_hours_en_fallback_test_ar", "source": "ccef711f-646d-4e3c-a480-d19586cdaade-attachment.html", "type": "text/html"}, {"name": "FAILED_test_semantic_en_ar_consistency[gdrfa_hours_en\\u2194fallback_test_ar]", "source": "de3ef742-e6e2-43b3-934a-242a1580f923-attachment.png", "type": "image/png"}], "parameters": [{"name": "pair", "value": "({'id': 'gdrfa_hours_en', 'lang': 'en', 'user': 'What are the working hours of GDRFA Dubai?', 'golden': 'GDRFA Dubai operates Sunday to Thursday during typical government hours; check the official website for the latest timings.', 'threshold': 0.8, 'must_contain': ['GDRFA', 'timings']}, {'id': 'fallback_test_ar', 'lang': 'ar', 'user': '!@#$٪^&*() معلومات غير مفهومة 123', 'golden': 'عذرًا، لم أفهم ذلك. هل يمكنك إعادة الصياغة أو توضيح ما تعنيه؟', 'xl_threshold': 0.8, 'must_contain': ['عذرًا', 'إعادة الصياغة', 'توضيح']})"}], "start": 1755619499192, "stop": 1755619523635, "uuid": "09c69474-a2a5-489f-aea0-1cece2c8663b", "historyId": "35c97a52efb667ca7ec7533d78a524db", "testCaseId": "c1ade53140c32ae7dc69f244b262fe50", "fullName": "tests.genai.test_semantic#test_semantic_en_ar_consistency", "labels": [{"name": "story", "value": "Responses should be semantically consistent across English and Arabic prompts"}, {"name": "epic", "value": "English <-> Arabic semantic consistency"}, {"name": "feature", "value": "Multilingual Semantic Consistency"}, {"name": "parentSuite", "value": "tests.genai"}, {"name": "suite", "value": "test_semantic"}, {"name": "host", "value": "LAPTOP-ITSGITUD"}, {"name": "thread", "value": "8660-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.genai.test_semantic"}]}